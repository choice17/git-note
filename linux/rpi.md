## rpi

## Content  

* **[keyboard_mapping](#keyboard_mapping)**  
* **[userid_default](#userid_default)**  
* **[network_setup](#network_setup)**  
* **[wifi_setup](#wifi_setup)**  
* **[install_anaconda](#install_anaconda)**  
* **[share drive-samba](#samba)**  
* **[faq](#faq)**  
* **[raspbian-mirror](#mirror)**  

## keyboard_mapping
https://thepihut.com/blogs/raspberry-pi-tutorials/25556740-changing-the-raspberry-pi-keyboard-layout

## userid_default

username:pi
pwd:raspberry

## network_setup

$ sudo raspi-config

## nginx
https://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html

## streaming to m3u8
https://www.martin-riedl.de/2018/08/24/using-ffmpeg-as-a-hls-streaming-server-part-1/


framerate 20 
iframe 40
quality 21

hlstime 4 segement

./ffmpeg -listen 1 -i <input> \
    -c:v copy -preset veryfast -r 20 -g 40 \
    -c:a aac -b:a 128k -ac 2 \
    -f hls -hls_time 4 -hls_playlist_type event stream.m3u8


## ffserver

ffserver -d -f <config>

ffmpeg -r 30 -s 640x480 -f video4linux2 -i <input> http://localhost:8090/feed1.ffm

nginx serving 
sudo nginx -c absolute path


## linux player

Guvcview


## enable_uart

https://www.circuits.dk/setup-raspberry-pi-3-gpio-uart/

## network

http://www.circuitbasics.com/how-to-set-up-a-static-ip-on-the-raspberry-pi/
static ip

https://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address

# wpa /etc/wpa_supplicant/wpa_supplicant.conf.


# Generated by resolvconf
nameserver 61.31.1.1
nameserver 168.95.1.1
nameserver 61.31.233.1

* Setup static ethernet0

```
/* /etc/dhcpcd.conf  */
interface eth0
static ip_address=<your static ip>
static routers=<gateway>
static domain_name_servers=<nameserver0> <nameserver1> <nameserver2>  

interface wlan0
static ip_address=10.0.0.99
static routers=10.0.0.1
static domain_name_servers=10.0.0.1 8.8.8.8
```

* Setup dynamic dhcp 

```
/* /etc/dhcpcd.conf */
==> simply command out the interface setup
==> default rapbian using dhcp connection
```


complete static ip
auto eth0
iface eth0 inet static
        address 10.1.1.30
        netmask 255.255.255.0
        gateway 10.1.1.1

allow-hotplug wlan0
iface wlan0 inet static
        address 10.1.1.31
        netmask 255.255.255.0
        gateway 10.1.1.1
    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf


## network_eth0_disappear

https://raspberrypi.stackexchange.com/questions/43560/raspberry-pi-3-eth0-wrongfully-named-enx?answertab=active#tab-top

1.
add
```
/etc/udev/rules.d/70-persistent-net.rules

SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="b8:ac:6f:65:31:e5", ATTR{dev_id}=="0x0", ATTR{type}=="1", KERNEL=="eth*", NAME="eth0"

"b8..." => "mac addr"
```

2. sudo raspi-config

Select "2. Network options"
Select "N3 Network interface names"
Select "No". It's now disabled predictable network interface names.
Click "OK" and "Finish". Then it will reboot your raspberry pi.

## PWM

https://www.raspberrypi.org/forums/viewtopic.php?t=150254

To be pedantic GPIO 12/13/18/19 all have hardware PWM and are available on Pis with the 40 pin expansion header (pins 32/33/12/35). However 12/18 share a setting as do 13/19.


## tcp connection
1. ssh
connect the board by ethernet-usb cable
wifi 
192.168.0.10

ethernet default ip: 
192.168.1.10



## wiringpi

https://elinux.org/RPi_GPIO_Code_Samples#WiringPi


## wifi_setup

* Search available wifi


$ sudo ifconfig wlan0 up
$ sudo iwlist wlan0 scan

* Check if rfkill is blocking

// show rfkill list
$ rfkill list

// SIOCSIFFLAGS: Operation not possible due to RF-kill
$ sudo rfkill unblock 0

## install_anaconda  

```
# Go to home directory
cd ~

# You can change what anaconda version you want at 
# https://repo.continuum.io/archive/
wget https://repo.continuum.io/archive/Anaconda3-4.2.0-Linux-x86_64.sh
bash Anaconda3-4.2.0-Linux-x86_64.sh -b -p ~/anaconda
rm Anaconda3-4.2.0-Linux-x86_64.sh
echo 'export PATH="~/anaconda/bin:$PATH"' >> ~/.bashrc 

# Refresh basically
source .bashrc

conda update conda
```

## samba  

1. https://www.footmark.info/embedded-systems/raspberry-pi/raspberry-pi3-samba-raspbian/
2. http://linux.vbird.org/linux_server/0370samba.php

```bash
$ sudo apt-get install samba
$ sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak // backup orign file
$ sudo systemctl start smb nmb
$ sudo systemctl enable smb nmb // enable samba service start when system up  
$ sudo vi /etc/samba/smb.conf
[resource-name]
    comment = Apache Directories
    path = /var/www/html
    writable = Yes
    browseable = Yes
    write list = apache
    directory mode = 0775
    create mode = 0664
    valid users = choi1
$ sudo testparm // test for param
$ sudo adduser choi // add user 
$ sudo smbpasswd -a choi // edit pwd
<enter pwd>
$ sudo pdbedit -L // check for valid user in samba
$ sudo pdbedit -x -u choi // remove user  
$ sudo systemctl restart smb nmb // start service  
$ or sudo systemctl restart smbd.service
$ or sudo systemctl restart nmbd.service
// window side  
$ folder -> this pc -> Add a network location -> \\192.168.1.xxx\resource-name
```
   
## admin  

http://linux.vbird.org/linux_basic/0410accountmanager.php

```
# add user with optional sudo authority
$ adduser {UserNameHere} <sudo>
or $ usermod -aG sudo {UserNameHere}

# change pwd
$ passwd {username}
```



## faq  

1. error occurred during the signature verification   
```bash
$ sudo apt-get clean 
$ cd /var/lib/apt 
$ sudo mv lists lists.old 
$ sudo mkdir -p lists/partial 
$ sudo apt-get clean 
$ sudo apt-get update
```
2. The following signatures couldn't be verified because the public key is not available at apt-get update
```bash
$ sudo apt-key adv --keyserver keys.gnupg.net --recv-keys <PUBKEY> 
or
$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <PUBKEY>
```

## mirror  

refer http://www.raspbian.org/RaspbianMirrors
